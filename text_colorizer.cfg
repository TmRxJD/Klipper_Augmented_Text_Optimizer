[gcode_macro text_colorizer]
gcode:
    {% set msg = namespace() %}
    {% set colored_text = namespace() %} 
    {% set message = params.MESSAGE|default("Welcome to the Text Colorizer!") | string %}
    {% set colors = ["primary", "error", "warning", "accent", "success", "secondary", "info"] %}
    
    {% set msg.out = "" %}
    
    {% for i in range(message | length) %}
        {% set text = message[i] | string %}
        {% set color = colors[i % colors | length ] | string %}
        {% set colored_text.out = '<span class=' + color + '--text>' + text + '</span>' | string %}
        {% set msg.out = msg.out + colored_text.out | string %}
    {% endfor %}
    
    { action_respond_info(msg.out) }   
